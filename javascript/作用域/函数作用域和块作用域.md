## 函数作用域和块作用域

- 函数是 javascript 中最常见的作用域单元。本质上，声明在一个函数内部的变量域函数会在所处的作用域中“隐藏”起来，这是有意为之的良好软件的设计原则。

- 函数的作用域在函数定义的时候就决定了，这是因为函数有一个内部属性[[scope]]，当函数创建的时候，就会保存所有父变量到其中，可以理解为[[scope]]就是所有父变量的层级链，但是注意：[[scope]]并不代表完整的作用域链

```
function foo(){
  function bar(){
    ...
  }
}

//函数创建时，各自的[[scope]]为：
foo.[[scope]]=[
  globalContext.VO
]
bar.[[scope]]=[
  fooContext.AO, // AO活动对象
  globalContext.VO // VO变量对象
]
```

- 函数不是唯一的作用域单元。块作用域指的是变量和函数不仅可以属性所处作用域也可以属于某个代码块（通常指｛...｝内部）

- 从 ES3 开始，try/catch 结构在 catch 分句中具有块作用域

- 从 ES6 中引入了 let 关键字，用来在任意代码块中声明变量，if(..){let a = 2;}会声明一个劫持了 if 的{...}块的变量，并且将变量添加到这个块中

- let 循环，可以发挥 let 优势的典型例子:

```
for(let i=0;i<10;i++){
  console.log(i);
}
console.log(i);

//相当于：
{
  let j;
  for(j=0;j<10;j++){
    let i=j; //每个迭代都重新绑定
    console.log(i);
  }
}
/*
  for循环的头部的let不仅将i绑定到了for循环的块中，事实上它将其重新绑定到了循环的每一个迭代中，**确保使用上一个循环迭代结束时的值重新进行赋值**
*/
```

- 函数作用域和块作用域的行为是一样的，可以总结为：任何声明在某个作用域内的变量，都将附属于这个作用域
