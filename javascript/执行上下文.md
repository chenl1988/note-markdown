## 执行上下文（execution context）

- javascript 中的可执行代码有三种：全局代码、函数代码、eval 代码

- 执行上下文-可以简单理解为一个对象：

  - 它包含三个部分：

    - 变量对象（Variable object，VO）：是执行上下文相关的数据作用域，存储了上下文中定义的变量和函数声明
    - 作用域链（Scope chain 词法作用域）
    - this 指向

  - 它的类型：

    - 全局执行上下文：全局上下文中的变量对象就是全局对象
    - 函数执行上下文：函数上下文中用活动对象(activation object, AO)来表示变量对象
    - eval 执行上下文

  - 代码执行过程：

    - 创建全局上下文（global EC）
    - 全局执行上下文（caller）逐行自上而下执行。遇到函数时，函数执行上下文（callee）被 push 到执行栈顶层
    - 函数执行上下文被激活，成为 active EC，开始执行函数中的代码，caller（全局执行上下文）被挂起
    - 函数执行完后，callee（函数执行上下文）被移出执行栈，控制权交还给全局执行上下文（caller）,继续执行

### 执行上下文栈（Execution context stack，ECS）

- javascript 引擎创建了执行上下文栈来管理执行上下文

- **当执行一个函数的时候，就会创建一个执行上下文，并且压入执行上下文栈，当函数执行完毕的时候，就会将函数的执行上下文从栈中弹出**

### 全局对象

- 全局上下文中的变量对象就是全局对象

- 全局对象是预定义的对象，作为 javascript 的全局函数和全局属性的占位符。通过使用全局对象，可以访问所有预定义的对象、函数和属性。

- 在 javascript 中，可以用 this 引用全局对象。因为全局对象是作用域链的头

### 函数上下文

- 在函数上下文中，我们用活动对象(activation object, AO)来表示变量对象。

- 只有当进入一个执行上下文中，这个执行上下文中的对象才会被激活，而只有被激活的变量对象，也就是活动对象上的各种属性才能被访问

- 活动对象是在进入函数上下文时被创建的，它通过函数的 arguments 属性初始化。arguments 属性值是 Arguments 对象
